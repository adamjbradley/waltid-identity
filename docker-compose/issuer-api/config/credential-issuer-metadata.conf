# EUDI Wallet Compatible Issuer Metadata
# Only includes credentials the EUDI Reference Wallet can process

supportedCredentialTypes = {
    # EUDI-compliant mDoc PID
    "eu.europa.ec.eudi.pid.1" = {
        format = mso_mdoc
        cryptographic_binding_methods_supported = ["cose_key"]
        credential_signing_alg_values_supported = ["ES256"]
        proof_types_supported = { jwt = { proof_signing_alg_values_supported = ["ES256"] } }
        doctype = "eu.europa.ec.eudi.pid.1"
        display = [
            {
                name = "EU Personal ID (mDoc)"
                locale = "en"
                logo = { url = "https://example.com/pid-logo.png", alt_text = "PID Logo" }
            }
        ]
        claims = {
            "eu.europa.ec.eudi.pid.1" = {
                family_name = { mandatory = true, display = [{ name = "Family Name", locale = "en" }] }
                given_name = { mandatory = true, display = [{ name = "Given Name", locale = "en" }] }
                birth_date = { mandatory = true, display = [{ name = "Date of Birth", locale = "en" }] }
                age_over_18 = { mandatory = false, display = [{ name = "Age Over 18", locale = "en" }] }
                issuance_date = { mandatory = true, display = [{ name = "Issuance Date", locale = "en" }] }
                expiry_date = { mandatory = true, display = [{ name = "Expiry Date", locale = "en" }] }
                issuing_authority = { mandatory = true, display = [{ name = "Issuing Authority", locale = "en" }] }
                issuing_country = { mandatory = true, display = [{ name = "Issuing Country", locale = "en" }] }
                nationality = { mandatory = false, display = [{ name = "Nationality", locale = "en" }] }
            }
        }
    }

    # EUDI-compliant mDoc mDL (Mobile Driving License)
    "org.iso.18013.5.1.mDL" = {
        format = mso_mdoc
        cryptographic_binding_methods_supported = ["cose_key"]
        credential_signing_alg_values_supported = ["ES256"]
        proof_types_supported = { jwt = { proof_signing_alg_values_supported = ["ES256"] } }
        doctype = "org.iso.18013.5.1.mDL"
        display = [
            {
                name = "Mobile Driving License"
                locale = "en"
                logo = { url = "https://example.com/mdl-logo.png", alt_text = "mDL Logo" }
            }
        ]
        claims = {
            "org.iso.18013.5.1" = {
                family_name = { mandatory = true, display = [{ name = "Family Name", locale = "en" }] }
                given_name = { mandatory = true, display = [{ name = "Given Name", locale = "en" }] }
                birth_date = { mandatory = true, display = [{ name = "Date of Birth", locale = "en" }] }
                issue_date = { mandatory = true, display = [{ name = "Issue Date", locale = "en" }] }
                expiry_date = { mandatory = true, display = [{ name = "Expiry Date", locale = "en" }] }
                issuing_country = { mandatory = true, display = [{ name = "Issuing Country", locale = "en" }] }
                issuing_authority = { mandatory = true, display = [{ name = "Issuing Authority", locale = "en" }] }
                document_number = { mandatory = true, display = [{ name = "Document Number", locale = "en" }] }
                portrait = { mandatory = false, display = [{ name = "Portrait", locale = "en" }] }
                driving_privileges = { mandatory = true, display = [{ name = "Driving Privileges", locale = "en" }] }
            }
        }
    }

    # EUDI-compliant SD-JWT PID
    "urn:eudi:pid:1" = {
        format = "dc+sd-jwt"
        cryptographic_binding_methods_supported = ["jwk"]
        credential_signing_alg_values_supported = ["ES256"]
        proof_types_supported = { jwt = { proof_signing_alg_values_supported = ["ES256"] } }
        vct = "urn:eudi:pid:1"
        display = [
            {
                name = "EU Personal ID (SD-JWT)"
                locale = "en"
                logo = { url = "https://example.com/pid-logo.png", alt_text = "PID Logo" }
            }
        ]
        credentialSubject = {
            family_name = { mandatory = true, display = [{ name = "Family Name", locale = "en" }] }
            given_name = { mandatory = true, display = [{ name = "Given Name", locale = "en" }] }
            birth_date = { mandatory = true, display = [{ name = "Date of Birth", locale = "en" }] }
            age_over_18 = { mandatory = false, display = [{ name = "Age Over 18", locale = "en" }] }
            issuance_date = { mandatory = true, display = [{ name = "Issuance Date", locale = "en" }] }
            expiry_date = { mandatory = true, display = [{ name = "Expiry Date", locale = "en" }] }
            issuing_authority = { mandatory = true, display = [{ name = "Issuing Authority", locale = "en" }] }
            issuing_country = { mandatory = true, display = [{ name = "Issuing Country", locale = "en" }] }
            nationality = { mandatory = false, display = [{ name = "Nationality", locale = "en" }] }
        }
    }

    # Payment Wallet Attestation (EWC RFC007)
    # Binds payment funding sources (cards, accounts) to EUDI wallets
    "PaymentWalletAttestation" = {
        format = "dc+sd-jwt"
        cryptographic_binding_methods_supported = ["jwk"]
        credential_signing_alg_values_supported = ["ES256"]
        proof_types_supported = { jwt = { proof_signing_alg_values_supported = ["ES256"] } }
        vct = "PaymentWalletAttestation"
        display = [
            {
                name = "Payment Wallet Attestation"
                locale = "en"
                description = "Attestation binding a payment funding source to this wallet"
                logo = { url = "https://example.com/pwa-logo.png", alt_text = "PWA Logo" }
            }
        ]
        credentialSubject = {
            funding_source = { mandatory = true, display = [{ name = "Funding Source", locale = "en" }] }
            "funding_source.type" = { mandatory = true, display = [{ name = "Type", locale = "en" }] }
            "funding_source.panLastFour" = { mandatory = false, display = [{ name = "Card Last 4", locale = "en" }] }
            "funding_source.iin" = { mandatory = false, display = [{ name = "Card Issuer", locale = "en" }] }
            "funding_source.ibanLastFour" = { mandatory = false, display = [{ name = "IBAN Last 4", locale = "en" }] }
            "funding_source.bic" = { mandatory = false, display = [{ name = "BIC", locale = "en" }] }
            "funding_source.scheme" = { mandatory = false, display = [{ name = "Payment Scheme", locale = "en" }] }
            "funding_source.currency" = { mandatory = false, display = [{ name = "Currency", locale = "en" }] }
            "funding_source.icon" = { mandatory = false, display = [{ name = "Icon", locale = "en" }] }
            "funding_source.aliasId" = { mandatory = false, display = [{ name = "Alias ID", locale = "en" }] }
        }
    }
}
